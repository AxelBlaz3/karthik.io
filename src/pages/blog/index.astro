---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

// Get all posts and sort by date
const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<Layout title="Blog | Karthik">
    <main class="max-w-4xl mx-auto px-6 py-20">
        <h1 class="text-4xl font-bold text-white mb-12">
            Engineering <span class="text-accent-primary">Log</span>
        </h1>

        <div class="space-y-8">
            {
                posts.map((post) => (
                    <a
                        href={`/blog/${post.slug}`}
                        class="block group p-6 rounded-2xl bg-astro-800/50 border border-astro-700 hover:border-accent-primary transition-all"
                    >
                        <div class="flex justify-between items-start mb-4">
                            <h2 class="text-2xl font-bold text-white group-hover:text-accent-primary transition-colors">
                                {post.data.title}
                            </h2>
                            <span class="text-slate-500 font-mono text-sm">
                                {post.data.pubDate.toLocaleDateString("en-US", {
                                    month: "short",
                                    day: "numeric",
                                    year: "numeric",
                                })}
                            </span>
                        </div>
                        <p class="text-slate-400 max-w-2xl">
                            {post.data.description}
                        </p>
                    </a>
                ))
            }
        </div>
    </main>
</Layout>
